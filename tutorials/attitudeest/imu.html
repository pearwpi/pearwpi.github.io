	<!DOCTYPE html>
	<html lang="zxx" class="no-js">
	<head>
		<!-- Mobile Specific Meta -->
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<!-- Favicon-->
		<link rel="shortcut icon" href="../../img/fav.png">
		<!-- Author Meta -->
		<meta name="author" content="colorlib">
		<!-- Meta Description -->
		<meta name="description" content="">
		<!-- Meta Keyword -->
		<meta name="keywords" content="">
		<!-- meta character set -->
		<meta charset="UTF-8">
		<!-- Site Title -->
		<title>Personal</title>

		<link href="https://fonts.googleapis.com/css?family=Poppins:100,200,400,300,500,600,700" rel="stylesheet"> 
			<!--
			CSS
			============================================= -->
			<link rel="stylesheet" href="../../css/linearicons.css">
			<link rel="stylesheet" href="../../css/font-awesome.min.css">
			<link rel="stylesheet" href="../../css/bootstrap.css">
			<link rel="stylesheet" href="../../css/magnific-popup.css">			
			<link rel="stylesheet" href="../../css/nice-select.css">							
			<link rel="stylesheet" href="../../css/animate.min.css">
			<link rel="stylesheet" href="../../css/owl.carousel.css">			
			<link rel="stylesheet" href="../../css/jquery-ui.css">			
			<link rel="stylesheet" href="../../css/main.css">
			<link href="../../css/icofont/icofont.min.css" rel="stylesheet">
		    <link href="../../css/remixicon/remixicon.css" rel="stylesheet">
		    <link href="../../css/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
		    <link href="../../css/boxicons/css/boxicons.min.css" rel="stylesheet">
		    <link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
		    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script type="text/javascript" id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
        </script>
        <!-- Global site tag (gtag.js) - Google Analytics -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-171009851-1"></script>
            <script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());

              gtag('config', 'UA-171009851-1');
            </script>
		</head>
		<body>	
		<!-- EDIT ME -->
		  <header id="header">
		    <div class="container main-menu">
		    	<div class="row align-items-center justify-content-between d-flex">
			      <div id="logo">
			        <a href="../index.html"><img src="../../img/logos/1.png" width="48px" alt="" title="" /></a>
			      </div>
			      <nav id="nav-menu-container">
			        <ul class="nav-menu">
			          <li><a href="../../index.html">Home</a></li>
                      <li><a href="../../about.html">About</a></li>
                      <li><a href="../../research.html">Research</a></li>
                      <li><a href="../../tutorials.html">Tutorials</a></li>
                      <li><a href="../../teaching.html">Teaching</a></li>
                      <li><a href="../../services.html">Services</a></li>
			        </ul>
			      </nav><!-- #nav-menu-container -->		    		
		    	</div>
		    </div>
		  </header><!-- #header -->
		  <!-- EDIT ME -->
		  

			<section class="sample-text-area">
                <div class="container">
                    <h3 class="text-heading"></h3>
                </div>
            </section>

            
			<!-- End Sample Area -->
			<!-- Start Align Area -->
			<div class="whole-wrap">
				<div class="container">
					<div class="section-top-border">
						<div class="row">
							<div class="col-md-6 mt-sm-20 left-align-p">
								<div class="">
									<ul class="unordered-list">
                                    <h3> Table of Contents: </h3><br>
                                    <li> <a href="#whatisanimu"> What is an IMU?</a> </li>
                                    <li> <a href="#mathimu"> Isn't Attitude Estimation trivial?</a> </li>
                                    <li> <a href="#cf"> Complementary Filter</a> </li>
                                    <li> <a href="#ref"> References</a> </li>
									</ul>
							</div>
							</div>
							<!-- <div class="col-md-6 mt-sm-20 right-align-p">
								<img src="img/research/PRGFlow.png" alt="" class="img-fluid">
							</div> -->
						</div>
						<hr>
                       

            <a name='whatisanimu'></a>
			
            <h3> What is an IMU? </h3><br><br>

            An IMU is the abbreviation for <b>Inertial Measurement Unit</b>. It generally comes packaged in two flavors: 6-DoF and 9-DoF, i.e., six degrees of freedom or nine degrees of freedom.<br><br>

            The first component of an IMU is called the <b>Gyroscope</b> or <b>Gyro</b> and it measures the angular velocity across an axis. So, you would need 3 gyros to compute angles in 3D. The best part about a gyro is that it is not affected by external forces and acceleration. Gyros work very well under dynamic conditions when rotational velocities are high, however they drift significantly with regard to time. Hence, the simplest filtering operation perfromed on gyro data is a high pass filter to remove low frequency drift.<br><br> 

            The second component of an IMU is called the <b>Accelerometer</b> or <b>Acc</b> and it measures the effective acceleration along an axis.  So, you would need 3 acc to compute angles in 3D given information about external forces. Acc are affected by vibration and other external forces and hence cannot be directly used for computing angles/attitude accurately. However, an acc works well in static conditions as opposed to the gyro. Hence, the simplest filtering operation perfromed on acc data is a low pass filter to remove dynamic noise from vibrations and other external factors. <br><br>

            Also, note that the readings from an IMU are greatly affected by temparature changes. The noise changes with temparature and as the IMU is being used due to "heating up" of the sensor. <br><br>

            A combination of 3 gyros and 3 acc (one in each of \(X, Y, Z\) axis) is called a 6-DoF IMU. <br><br>

            A 9-DoF IMU also includes a 3-axis magnetometer which measures Earth's magnetic field which can be used to obtain orientation information as well. However, for indoor operation which has a lot of metal structures, the magnetometer is generally inaccurate as is exluded from the data fusion. The magnetometer is also often called the <b>Digital Compass</b> as it can be directly used to compute the North pole direction. <br><br>

            <hr>

            <a name='mathimu'></a>

            <h3> Mathematical Model of an IMU </h3><br><br>

            Let us assume that our IMU is a 6-DoF one, i.e., it has a 3 axis gyro and a 3 axis acc. A 9-DoF IMU is commonly called MARG (Magnetic, Angular Rate and Gravity) sensor. A simple mathematical model of the gyro and acc is given below.<br><br>

            <h5> Gyroscope Model:</h5><br>

            \( \omega = \hat{\omega} + \mathbf{b}_g + \mathbf{n}_g \) <br><br>

            Here, \(\omega\) is the measured angular velocity from the gyro, \(\hat{\omega}\) is the latent ideal angular velocity we wish to recover, \(\mathbf{b}_g\) is the gyro bias which changes with time and other factors like temparature, \(\mathbf{n}_g\) is the white gaussian gyro noise.<br><br>


            The gyro bias is modelled as \(\mathbf{\dot{b}}_g = \mathbf{b}_{bg}(t) \sim \mathcal{N}(0, Q_g)\) where \(Q_g\) is the covariance matrix which models gyro noise. <br><br>



            <h5>Accelerometer Model:</h5><br><br>

            \( \mathbf{a} = R^T(\mathbf{\hat{a}} - \mathbf{g}) + \mathbf{b}_a + \mathbf{n}_a \) <br><br>

            Here, \(\mathbf{a}\) is the measured acceleration from the acc, \(\mathbf{\hat{a}}\) is the latent ideal acceleration we wish to recover, $$R$$ is the orientation of the sensor in the world frame, \(\mathbf{g}\) is the acceleration due to gravity in the world frame, \(\mathbf{b}_a\) is the acc bias which changes with time and other factors like temparature, \(\mathbf{n}_a\) is the the white gaussian acc noise.<br><br>


            The acc bias is modelled as \(\mathbf{\dot{b}}_a = \mathbf{b}_{ba}(t) \sim \mathcal{N}(0, Q_a)\) where \(Q_a\) is the covariance matrix which models acc noise. <br><br>


            Here the orientation of the sensor is either known from external sources such as a motion capture system or a camera or estimated by sensor fusion. <br><br>

            <hr>

            <a name='trivial'></a>

            <h3> Isn't Attitude Estimation trivial? </h3><br><br>

            You might be thinking if the gyro gives angular acceleration wouldn't attitude estimation be as trivial as integrating these measurements. You would be right! In an <b>ideal</b> world this would work perfectly and we would have the perfect attitude. However, real world is very different and the gyro has both an unknown changing bias and noise. Even if you want the system to work for a small amount of time, say 4 sec where you could assume that the bias doesnt change and can be obtained as averaging measurements when the gyro is at rest. The noise though being small accumulates over time when integrated eventually becoming unbounded in magnitude completely masking the signal. <br><br>

            Keen readers might think, why cant we just low pass filter this signal and then integrate? This is a good idea but would cause a significant lag in the measurements and alter the magnitudes of the high frequency signals where gyro works well. This is no good for us. Also, note that integtation works as a form of <a href="https://webhome.phy.duke.edu/~schol/phy271/faqs/faq8/node6.html">low pass filtering</a>. <br><br>

            Next, one might be thinking why cant we use acc measurements to estimate attitude when only gravity is acting on it? The answer is yes you can do it in an <b>ideal world</b>. In reality, the measurements are too noisy and don't work well when the device is in motion or for high speed motion. Hence necessitating fusing both these sensors. The gyro works well at higher frequency motion (fast movements but drifts over time) while the acc works well at lower frequency motion (works well over long period of time but is inaccurate for fast motion). The gyro and acc have complementary errors, i.e., both are errnoeous but in different bands of the frequency spectrum and hence can be fused to get much more accurate measurements then one could ever get with either of the sensors separately. Hence the name <b>Complementary Filter</b> which is described next. <br><br>

            <hr>

            <a name='cf'></a>

            <h3>  Complementary Filter for Attitude Estimation </h3><br><br>

            The simplest  way to estimate angles/attitude/orientation of the IMU in world is by fusing data from gyros and acc using a <b>Complementary Filter</b>. <br><br>

            Like we mentioned before, we high pass the gyro data and low pass the acc data. <br><br>

            Let \(\mathbf{\omega} = [\omega_x, \omega_y, \omega_z]^T\) and \(\mathbf{a} = [a_x, a_y, a_z]^T\) denote the raw measured data from the gyros and acc respectively. <br><br>

            The low pass filtered acc data is given by<br><br>

            \(\mathbf{\hat{a}}_{t+1} = (1-\alpha)\mathbf{a}_{t+1} + \alpha \mathbf{\hat{a}}_{t}\) <br><br>


            The high pass filtered gyro data is given by<br><br>

            \(\mathbf{\hat{\omega}}_{t+1} = (1-\alpha)\mathbf{\hat{\omega}}_{t} + (1-\alpha)(\mathbf{\omega}_{t+1} - \mathbf{\omega}_{t})\) <br><br>

            Here the \(\hat{x}\) denotes the filtered version of \(x\) and \(t\) denotes time sample and \(\alpha\) controls the frequency boundary where to switch from trusting the acc to trusting the gyros. <br><br>

            \(\alpha\) can be chosen as \(\alpha = \frac{\tau}{\tau + dt}\) where \(\tau\) is the desired time constant - how fast you want the readings to respond and \(dt = f_s^{-1}\) is the inverse of sampling frequency \(f_s\). Generally \(\alpha > 0.5\) is used. <br><br>

            The final equation for fusing gyro and acc data into a complementary filter is given below<br><br>

            \( Ang_{t+1} = (1 - \alpha)(Ang_t + \mathbf{\omega}_{t+1}dt) + \alpha\mathbf{a}_{t+1}\) <br><br>
             
            Here the gyro data is integrated to obtain angles.<br><br>

            <hr>

            <a name='ref'></a>

            <h3>  References </h3><br>
            <ol class="unordered-list">
                 <li> <a href="https://sites.google.com/site/myimuestimationexperience/filters/complementary-filter"> My IMU estimation experience blog</a> </li>
                 <li> <a href="http://philsal.co.uk/projects/imu-attitude-estimation"> IMU Attitude Estimation</a> </li>
           </ol>



            </div>
        </div>
    </div>


            <!-- EDIT FOOT -->
            <!-- start footer Area -->
            <footer class="footer-area section-gap">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-5 col-md-6 col-sm-6">
                            <div class="single-footer-widget">
                                <p class="footer-text"><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-6 col-sm-6 social-widget">
                            <div class="single-footer-widget">
                                <h4>Follow Me</h4>
                                <p>Let us be social</p>
                                <div class="footer-social d-flex align-items-center">
                                  <a title="Google Scholar" href="https://scholar.google.com/citations?user=ugyWSWwAAAAJ&hl=en&oi=ao" style="padding-top: 8px" class="ai"><i class="ai ai-google-scholar"></i></a>&nbsp;
                                  <a title="Github" href="http://github.com/nitinjsanket/" class="github"><i class="fa fa-github"></i></a>&nbsp;
                                  <a title="Teaching on YouTube" href="http://youtube.com/prgumdteaching" class="youtube"><i class="fa fa-youtube-square"></i></a>&nbsp;
                                  <a title="LinkedIn" href="https://www.linkedin.com/in/nitinjsanket/" class="linkedin"><i class="fa fa-linkedin-square"></i></a>&nbsp;
                                  <a title="Twitter" href="http://twitter.com/nitinjsanket" class="twitter"><i class="fa fa-twitter-square"></i></a>&nbsp;
                                  <a title="500px" href="https://500px.com/nitinjsanket" class="500px"><i class="fa fa-500px"></i></a>&nbsp;
                                  <a title="Instagram" href="http://instagram.com/firenitin" class="instagram"><i class="fa fa-instagram"></i></a>&nbsp;
                                  <a title="Photography" href="http://instagram.com/njsphoto" class="camera"><i class="fa fa-camera"></i></a>&nbsp;
                                  <a title="Facebook" href="http://facebook.com//nitin.jsanket" class="facebook"><i class="fa fa-facebook-square"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
            <!-- End footer Area -->        
            <!-- EDIT FOOT -->

			<script src="js/vendor/jquery-2.2.4.min.js"></script>
			<script src="js/popper.min.js"></script>
			<script src="js/vendor/bootstrap.min.js"></script>			
			<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhOdIF3Y9382fqJYt5I_sswSrEw5eihAA"></script>			
  			<script src="js/easing.min.js"></script>			
			<script src="js/hoverIntent.js"></script>
			<script src="js/superfish.min.js"></script>	
			<script src="js/jquery.ajaxchimp.min.js"></script>
			<script src="js/jquery.magnific-popup.min.js"></script>	
    		<script src="js/jquery.tabs.min.js"></script>						
			<script src="js/jquery.nice-select.min.js"></script>	
            <script src="js/isotope.pkgd.min.js"></script>			
			<script src="js/waypoints.min.js"></script>
			<script src="js/jquery.counterup.min.js"></script>
			<script src="js/simple-skillbar.js"></script>							
			<script src="js/owl.carousel.min.js"></script>							
			<script src="js/mail-script.js"></script>	
			<script src="js/main.js"></script>	
		</body>
	</html>






